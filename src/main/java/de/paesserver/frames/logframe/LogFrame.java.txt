package de.paesserver.frames.logframe;

import de.paesserver.journalLog.JournalLogRunner;

import javax.swing.*;
import javax.swing.event.MenuEvent;
import javax.swing.event.MenuListener;

import java.awt.*;
import java.io.File;

public class LogFrameOLD implements MenuListener {
    Container container;
    JournalLogRunner journalLogRunner;
    public LogFrameOLD(Container container){
        this.container = container;
    }

    @Override
    public void menuSelected(MenuEvent e) {
        //Create terminal for output
        GridBagConstraints constraints;

        //System info
        JTextArea systemInfo =  LogFrameComponents.getSystemInfoTextArea();

        constraints = new GridBagConstraints();
        constraints.fill = GridBagConstraints.BOTH;
        constraints.gridx = 0;
        constraints.gridy = 1;
        constraints.weightx = 1;
        constraints.weighty = 0.7;
        constraints.gridheight = 2;
        container.add(systemInfo,constraints);

        //Signals
        JTable systemSignalTable = LogFrameComponents.getSignalTable();

        constraints = new GridBagConstraints();
        constraints.fill = GridBagConstraints.BOTH;
        constraints.gridx = 0;
        constraints.gridy = 3;
        constraints.weightx = 1.0;
        constraints.weighty = 0.8;
        constraints.gridheight = 1;

        JScrollPane scrollPane = new JScrollPane(systemSignalTable);
        scrollPane.setSize(50,200);
        scrollPane.createVerticalScrollBar().setVisible(true);
        container.add(scrollPane,constraints);

        //Planet Info
        JTextArea bodyInfo = LogFrameComponents.getPlanetInfoTextArea();

        constraints = new GridBagConstraints();
        constraints.fill = GridBagConstraints.BOTH;
        constraints.weightx = 1.0;
        constraints.weighty = 1.0;
        constraints.ipady = 40;
        constraints.gridx = 2;
        constraints.gridy = 1;
        constraints.gridheight = 3;
        container.add(bodyInfo,constraints);

        //Planets
        constraints = new GridBagConstraints();
        constraints.fill = GridBagConstraints.BOTH;
        constraints.weightx = 1.0;
        constraints.weighty = 1.0;
        constraints.ipady = 40;
        constraints.gridx = 1;
        constraints.gridy = 1;
        constraints.gridheight = 3;
        JTree tree = new JTree();

        JScrollPane planetScrollPane = new JScrollPane(tree);
        planetScrollPane.createHorizontalScrollBar().setVisible(true);
        container.add(planetScrollPane,constraints);

        //Creating LogParser and giving it the textArea, where it can write into
        if(journalLogRunner == null){
            journalLogRunner = new JournalLogRunner();
            Thread thread = new Thread(journalLogRunner);
            thread.start();
        }else{
            journalLogRunner.setHalt(false);
        }


        //Reset Button
        JButton resetButton =  new JButton("Reset Reader");
        resetButton.setFont(LogFrameComponents.globalFont);

        constraints = new GridBagConstraints();
        constraints.fill = GridBagConstraints.BOTH;
        constraints.gridx = 0;
        constraints.gridy = 4;
        constraints.gridwidth = 3;

        resetButton.addActionListener(a -> {
            try {
                File log = journalLogRunner.parser.getLatestLogInWorkingDirectory();
                journalLogRunner.setHalt(true);
                journalLogRunner.parser.closeReader();
                if(journalLogRunner.parser.setBufferedReaderForFile(log))
                    journalLogRunner.setHalt(false);
                else
                    throw new Exception("There was an error starting the buffered reader");
            } catch (Exception ex) {
                ex.printStackTrace();
            }
        });

        container.add(resetButton,constraints);

    }

    public void stopThread(){
        journalLogRunner.stop();
    }

    public void haltThread(boolean b){
        journalLogRunner.setHalt(b);
    }


    @Override
    public void menuDeselected(MenuEvent e) {

    }

    @Override
    public void menuCanceled(MenuEvent e) {

    }
}
